<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="PyOTP - The Python One-Time Password Library" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://pyauth.github.io/pyotp/index.html" />
<meta property="og:site_name" content="PyOTP" />
<meta property="og:description" content="PyOTP is a Python library for generating and verifying one-time passwords. It can be used to implement two-factor (2FA) or multi-factor (MFA) authentication methods in web applications and in other..." />
<meta name="description" content="PyOTP is a Python library for generating and verifying one-time passwords. It can be used to implement two-factor (2FA) or multi-factor (MFA) authentication methods in web applications and in other..." />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Release Notes" href="changelog.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>PyOTP documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">PyOTP  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  
  <span class="sidebar-brand-text">PyOTP  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><ul>
<li><a class="reference internal" href="#">PyOTP - The Python One-Time Password Library</a><ul>
<li><a class="reference internal" href="#quick-overview-of-using-one-time-passwords-on-your-phone">Quick overview of using One Time Passwords on your phone</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#time-based-otps">Time-based OTPs</a></li>
<li><a class="reference internal" href="#counter-based-otps">Counter-based OTPs</a></li>
<li><a class="reference internal" href="#generating-a-secret-key">Generating a Secret Key</a></li>
<li><a class="reference internal" href="#google-authenticator-compatible">Google Authenticator Compatible</a></li>
<li><a class="reference internal" href="#working-example">Working example</a></li>
<li><a class="reference internal" href="#third-party-contributions">Third-party contributions</a></li>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pyotp">API documentation</a><ul>
<li><a class="reference internal" href="#pyotp.parse_uri"><code class="docutils literal notranslate"><span class="pre">parse_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP"><code class="docutils literal notranslate"><span class="pre">TOTP</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.totp.TOTP.at"><code class="docutils literal notranslate"><span class="pre">TOTP.at()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.now"><code class="docutils literal notranslate"><span class="pre">TOTP.now()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.provisioning_uri"><code class="docutils literal notranslate"><span class="pre">TOTP.provisioning_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.timecode"><code class="docutils literal notranslate"><span class="pre">TOTP.timecode()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.verify"><code class="docutils literal notranslate"><span class="pre">TOTP.verify()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP"><code class="docutils literal notranslate"><span class="pre">HOTP</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.at"><code class="docutils literal notranslate"><span class="pre">HOTP.at()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.provisioning_uri"><code class="docutils literal notranslate"><span class="pre">HOTP.provisioning_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.verify"><code class="docutils literal notranslate"><span class="pre">HOTP.verify()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyotp.utils.build_uri"><code class="docutils literal notranslate"><span class="pre">build_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.utils.strings_equal"><code class="docutils literal notranslate"><span class="pre">strings_equal()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.contrib.steam.Steam"><code class="docutils literal notranslate"><span class="pre">Steam</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.contrib.steam.Steam.generate_otp"><code class="docutils literal notranslate"><span class="pre">Steam.generate_otp()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id5">Change log</a></li>
</ul>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pyotp-the-python-one-time-password-library">
<h1>PyOTP - The Python One-Time Password Library<a class="headerlink" href="#pyotp-the-python-one-time-password-library" title="Link to this heading">¶</a></h1>
<p>PyOTP is a Python library for generating and verifying one-time passwords. It can be used to implement two-factor (2FA)
or multi-factor (MFA) authentication methods in web applications and in other systems that require users to log in.</p>
<p>Open MFA standards are defined in <a class="reference external" href="https://tools.ietf.org/html/rfc4226">RFC 4226</a> (HOTP: An HMAC-Based One-Time
Password Algorithm) and in <a class="reference external" href="https://tools.ietf.org/html/rfc6238">RFC 6238</a> (TOTP: Time-Based One-Time Password
Algorithm). PyOTP implements server-side support for both of these standards. Client-side support can be enabled by
sending authentication codes to users over SMS or email (HOTP) or, for TOTP, by instructing users to use <a class="reference external" href="https://en.wikipedia.org/wiki/Google_Authenticator">Google
Authenticator</a>, <a class="reference external" href="https://www.authy.com/">Authy</a>, or another
compatible app. Users can set up auth tokens in their apps easily by using their phone camera to scan <a class="reference external" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">otpauth://</a> QR codes provided by PyOTP.</p>
<p>Implementers should read and follow the <a class="reference external" href="https://tools.ietf.org/html/rfc4226#section-7">HOTP security requirements</a>
and <a class="reference external" href="https://tools.ietf.org/html/rfc6238#section-5">TOTP security considerations</a> sections of the relevant RFCs. At
minimum, application implementers should follow this checklist:</p>
<ul class="simple">
<li><p>Ensure transport confidentiality by using HTTPS</p></li>
<li><p>Ensure HOTP/TOTP secret confidentiality by storing secrets in a controlled access database</p></li>
<li><p>Deny replay attacks by rejecting one-time passwords that have been used by the client (this requires storing the most
recently authenticated timestamp, OTP, or hash of the OTP in your database, and rejecting the OTP when a match is
seen)</p></li>
<li><p>Throttle (rate limit) brute-force attacks against your application’s login functionality (see RFC 4226, section 7.3)</p></li>
<li><p>When implementing a “greenfield” application, consider supporting
<a class="reference external" href="https://en.wikipedia.org/wiki/Universal_2nd_Factor">FIDO U2F</a>/<a class="reference external" href="https://www.w3.org/TR/webauthn/">WebAuthn</a> in
addition to or instead of HOTP/TOTP. U2F uses asymmetric cryptography to avoid using a shared secret design, which
strengthens your MFA solution against server-side attacks. Hardware U2F also sequesters the client secret in a
dedicated single-purpose device, which strengthens your clients against client-side attacks. And by automating scoping
of credentials to relying party IDs (application origin/domain names), U2F adds protection against phishing attacks.
One implementation of FIDO U2F/WebAuthn is PyOTP’s sister project, <a class="reference external" href="https://github.com/pyauth/pywarp">PyWARP</a>.</p></li>
</ul>
<p>We also recommend that implementers read the
<a class="reference external" href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Authentication_Cheat_Sheet.md">OWASP Authentication Cheat Sheet</a> and
<a class="reference external" href="https://pages.nist.gov/800-63-3/">NIST SP 800-63-3: Digital Authentication Guideline</a> for a high level overview of
authentication best practices.</p>
<section id="quick-overview-of-using-one-time-passwords-on-your-phone">
<h2>Quick overview of using One Time Passwords on your phone<a class="headerlink" href="#quick-overview-of-using-one-time-passwords-on-your-phone" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>OTPs involve a shared secret, stored both on the phone and the server</p></li>
<li><p>OTPs can be generated on a phone without internet connectivity</p></li>
<li><p>OTPs should always be used as a second factor of authentication (if your phone is lost, you account is still secured
with a password)</p></li>
<li><p>Google Authenticator and other OTP client apps allow you to store multiple OTP secrets and provision those using a QR
Code</p></li>
</ul>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyotp</span>
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<section id="time-based-otps">
<h3>Time-based OTPs<a class="headerlink" href="#time-based-otps" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyotp</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">totp</span> <span class="o">=</span> <span class="n">pyotp</span><span class="o">.</span><span class="n">TOTP</span><span class="p">(</span><span class="s1">&#39;base32secret3232&#39;</span><span class="p">)</span>
<span class="n">totp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="c1"># =&gt; &#39;492039&#39;</span>

<span class="c1"># OTP verified for current time</span>
<span class="n">totp</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;492039&#39;</span><span class="p">)</span> <span class="c1"># =&gt; True</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">totp</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;492039&#39;</span><span class="p">)</span> <span class="c1"># =&gt; False</span>
</pre></div>
</div>
</section>
<section id="counter-based-otps">
<h3>Counter-based OTPs<a class="headerlink" href="#counter-based-otps" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyotp</span>

<span class="n">hotp</span> <span class="o">=</span> <span class="n">pyotp</span><span class="o">.</span><span class="n">HOTP</span><span class="p">(</span><span class="s1">&#39;base32secret3232&#39;</span><span class="p">)</span>
<span class="n">hotp</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># =&gt; &#39;260182&#39;</span>
<span class="n">hotp</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># =&gt; &#39;055283&#39;</span>
<span class="n">hotp</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">1401</span><span class="p">)</span> <span class="c1"># =&gt; &#39;316439&#39;</span>

<span class="c1"># OTP verified with a counter</span>
<span class="n">hotp</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;316439&#39;</span><span class="p">,</span> <span class="mi">1401</span><span class="p">)</span> <span class="c1"># =&gt; True</span>
<span class="n">hotp</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;316439&#39;</span><span class="p">,</span> <span class="mi">1402</span><span class="p">)</span> <span class="c1"># =&gt; False</span>
</pre></div>
</div>
</section>
<section id="generating-a-secret-key">
<h3>Generating a Secret Key<a class="headerlink" href="#generating-a-secret-key" title="Link to this heading">¶</a></h3>
<p>A helper function is provided to generate a 32-character base32 secret, compatible with Google Authenticator and other
OTP apps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyotp</span><span class="o">.</span><span class="n">random_base32</span><span class="p">()</span>
</pre></div>
</div>
<p>Some applications want the secret key to be formatted as a hex-encoded string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyotp</span><span class="o">.</span><span class="n">random_hex</span><span class="p">()</span>  <span class="c1"># returns a 40-character hex-encoded secret</span>
</pre></div>
</div>
</section>
<section id="google-authenticator-compatible">
<h3>Google Authenticator Compatible<a class="headerlink" href="#google-authenticator-compatible" title="Link to this heading">¶</a></h3>
<p>PyOTP works with the Google Authenticator iPhone and Android app, as well as other OTP apps like Authy. PyOTP includes
the ability to generate provisioning URIs for use with the QR Code scanner built into these MFA client apps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyotp</span><span class="o">.</span><span class="n">totp</span><span class="o">.</span><span class="n">TOTP</span><span class="p">(</span><span class="s1">&#39;JBSWY3DPEHPK3PXP&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">provisioning_uri</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;alice@google.com&#39;</span><span class="p">,</span> <span class="n">issuer_name</span><span class="o">=</span><span class="s1">&#39;Secure App&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;otpauth://totp/Secure%20App:alice</span><span class="si">%40g</span><span class="s1">oogle.com?secret=JBSWY3DPEHPK3PXP&amp;issuer=Secure%20App&#39;</span>

<span class="n">pyotp</span><span class="o">.</span><span class="n">hotp</span><span class="o">.</span><span class="n">HOTP</span><span class="p">(</span><span class="s1">&#39;JBSWY3DPEHPK3PXP&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">provisioning_uri</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;alice@google.com&quot;</span><span class="p">,</span> <span class="n">issuer_name</span><span class="o">=</span><span class="s2">&quot;Secure App&quot;</span><span class="p">,</span> <span class="n">initial_count</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;otpauth://hotp/Secure%20App:alice</span><span class="si">%40g</span><span class="s1">oogle.com?secret=JBSWY3DPEHPK3PXP&amp;issuer=Secure%20App&amp;counter=0&#39;</span>
</pre></div>
</div>
<p>This URL can then be rendered as a QR Code (for example, using <a class="reference external" href="https://github.com/soldair/node-qrcode">https://github.com/soldair/node-qrcode</a>) which can then be
scanned and added to the users list of OTP credentials.</p>
<p>Parsing these URLs is also supported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyotp</span><span class="o">.</span><span class="n">parse_uri</span><span class="p">(</span><span class="s1">&#39;otpauth://totp/Secure%20App:alice</span><span class="si">%40g</span><span class="s1">oogle.com?secret=JBSWY3DPEHPK3PXP&amp;issuer=Secure%20App&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">pyotp</span><span class="o">.</span><span class="n">totp</span><span class="o">.</span><span class="n">TOTP</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0xFFFFFFFF</span><span class="o">&gt;</span>

<span class="n">pyotp</span><span class="o">.</span><span class="n">parse_uri</span><span class="p">(</span><span class="s1">&#39;otpauth://hotp/Secure%20App:alice</span><span class="si">%40g</span><span class="s1">oogle.com?secret=JBSWY3DPEHPK3PXP&amp;issuer=Secure%20App&amp;counter=0&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">pyotp</span><span class="o">.</span><span class="n">totp</span><span class="o">.</span><span class="n">HOTP</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0xFFFFFFFF</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="working-example">
<h3>Working example<a class="headerlink" href="#working-example" title="Link to this heading">¶</a></h3>
<p>Scan the following barcode with your phone’s OTP app (e.g. Google Authenticator):</p>
<img alt="https://quickchart.io/qr?size=250&amp;text=otpauth%3A%2F%2Ftotp%2Falice%40google.com%3Fsecret%3DJBSWY3DPEHPK3PXP" src="https://quickchart.io/qr?size=250&amp;text=otpauth%3A%2F%2Ftotp%2Falice%40google.com%3Fsecret%3DJBSWY3DPEHPK3PXP" />
<p>Now run the following and compare the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyotp</span>
<span class="n">totp</span> <span class="o">=</span> <span class="n">pyotp</span><span class="o">.</span><span class="n">TOTP</span><span class="p">(</span><span class="s2">&quot;JBSWY3DPEHPK3PXP&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current OTP:&quot;</span><span class="p">,</span> <span class="n">totp</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="third-party-contributions">
<h3>Third-party contributions<a class="headerlink" href="#third-party-contributions" title="Link to this heading">¶</a></h3>
<p>The following third-party contributions are not described by a standard, not officially supported, and provided for
reference only:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pyotp.contrib.Steam()</span></code>: An implementation of Steam TOTP. Uses the same API as <cite>pyotp.TOTP()</cite>.</p></li>
</ul>
</section>
<section id="links">
<h3>Links<a class="headerlink" href="#links" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pyauth/pyotp">Project home page (GitHub)</a></p></li>
<li><p><a class="reference external" href="https://pyauth.github.io/pyotp/">Documentation</a></p></li>
<li><p><a class="reference external" href="https://pypi.python.org/pypi/pyotp">Package distribution (PyPI)</a></p></li>
<li><p><a class="reference external" href="https://github.com/pyauth/pyotp/blob/master/Changes.rst">Change log</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc4226">RFC 4226: HOTP: An HMAC-Based One-Time Password</a></p></li>
<li><p><a class="reference external" href="https://tools.ietf.org/html/rfc6238">RFC 6238: TOTP: Time-Based One-Time Password Algorithm</a></p></li>
<li><p><a class="reference external" href="https://github.com/mdp/rotp">ROTP</a> - Original Ruby OTP library by <a class="reference external" href="https://github.com/mdp">Mark Percival</a></p></li>
<li><p><a class="reference external" href="https://github.com/lelag/otphp">OTPHP</a> - PHP port of ROTP by <a class="reference external" href="https://github.com/lelag">Le Lag</a></p></li>
<li><p><a class="reference external" href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Authentication_Cheat_Sheet.md">OWASP Authentication Cheat Sheet</a></p></li>
<li><p><a class="reference external" href="https://pages.nist.gov/800-63-3/">NIST SP 800-63-3: Digital Authentication Guideline</a></p></li>
</ul>
<p>For new applications:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.w3.org/TR/webauthn/">WebAuthn</a></p></li>
<li><p><a class="reference external" href="https://github.com/pyauth/pywarp">PyWARP</a></p></li>
</ul>
</section>
<section id="versioning">
<h3>Versioning<a class="headerlink" href="#versioning" title="Link to this heading">¶</a></h3>
<p>This package follows the <a class="reference external" href="http://semver.org/">Semantic Versioning 2.0.0</a> standard. To control changes, it is
recommended that application developers pin the package version and manage it using <a class="reference external" href="https://github.com/jazzband/pip-tools">pip-tools</a> or similar. For library developers, pinning the major version is
recommended.</p>
<a class="reference external image-reference" href="https://github.com/pyauth/pyotp/actions"><img alt="https://github.com/pyauth/pyotp/workflows/Python%20package/badge.svg" src="https://github.com/pyauth/pyotp/workflows/Python%20package/badge.svg" /></a>
<a class="reference external image-reference" href="https://codecov.io/github/pyauth/pyotp?branch=master"><img alt="https://img.shields.io/codecov/c/github/pyauth/pyotp/master.svg" src="https://img.shields.io/codecov/c/github/pyauth/pyotp/master.svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/pyotp"><img alt="https://img.shields.io/pypi/v/pyotp.svg" src="https://img.shields.io/pypi/v/pyotp.svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/pyotp"><img alt="https://img.shields.io/pypi/l/pyotp.svg" src="https://img.shields.io/pypi/l/pyotp.svg" /></a>
<a class="reference external image-reference" href="https://pyotp.readthedocs.io/"><img alt="https://readthedocs.org/projects/pyotp/badge/?version=latest" src="https://readthedocs.org/projects/pyotp/badge/?version=latest" /></a>
</section>
</section>
</section>
<section id="module-pyotp">
<span id="api-documentation"></span><h1>API documentation<a class="headerlink" href="#module-pyotp" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pyotp.parse_uri">
<span class="sig-prename descclassname"><span class="pre">pyotp.</span></span><span class="sig-name descname"><span class="pre">parse_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">OTP</span></span></span><a class="reference internal" href="_modules/pyotp.html#parse_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.parse_uri" title="Link to this definition">¶</a></dt>
<dd><p>Parses the provisioning URI for the OTP; works for either TOTP or HOTP.</p>
<dl class="simple">
<dt>See also:</dt><dd><p><a class="reference external" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">https://github.com/google/google-authenticator/wiki/Key-Uri-Format</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uri</strong> – the hotp/totp URI to parse</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>OTP object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-pyotp.totp">
<dt class="sig sig-object py" id="pyotp.totp.TOTP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyotp.totp.</span></span><span class="sig-name descname"><span class="pre">TOTP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP" title="Link to this definition">¶</a></dt>
<dd><p>Handler for time-based OTP counters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyotp.totp.TOTP.at">
<span class="sig-name descname"><span class="pre">at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">for_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">counter_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP.at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP.at" title="Link to this definition">¶</a></dt>
<dd><p>Accepts either a Unix timestamp integer or a datetime object.</p>
<p>To get the time until the next timecode change (seconds until the current OTP expires), use this instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">totp</span> <span class="o">=</span> <span class="n">pyotp</span><span class="o">.</span><span class="n">TOTP</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">time_remaining</span> <span class="o">=</span> <span class="n">totp</span><span class="o">.</span><span class="n">interval</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">%</span> <span class="n">totp</span><span class="o">.</span><span class="n">interval</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>for_time</strong> – the time to generate an OTP for</p></li>
<li><p><strong>counter_offset</strong> – the amount of ticks to add to the time counter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>OTP value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.totp.TOTP.now">
<span class="sig-name descname"><span class="pre">now</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP.now"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP.now" title="Link to this definition">¶</a></dt>
<dd><p>Generate the current time OTP</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>OTP value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.totp.TOTP.provisioning_uri">
<span class="sig-name descname"><span class="pre">provisioning_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP.provisioning_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP.provisioning_uri" title="Link to this definition">¶</a></dt>
<dd><p>Returns the provisioning URI for the OTP.  This can then be
encoded in a QR Code and used to provision an OTP app like
Google Authenticator.</p>
<dl class="simple">
<dt>See also:</dt><dd><p><a class="reference external" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">https://github.com/google/google-authenticator/wiki/Key-Uri-Format</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.totp.TOTP.timecode">
<span class="sig-name descname"><span class="pre">timecode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">for_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP.timecode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP.timecode" title="Link to this definition">¶</a></dt>
<dd><p>Accepts either a timezone naive (<cite>for_time.tzinfo is None</cite>) or
a timezone aware datetime as argument and returns the
corresponding counter value (timecode).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.totp.TOTP.verify">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">for_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/pyotp/totp.html#TOTP.verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.totp.TOTP.verify" title="Link to this definition">¶</a></dt>
<dd><p>Verifies the OTP passed in against the current time OTP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>otp</strong> – the OTP to check against</p></li>
<li><p><strong>for_time</strong> – Time to check OTP at (defaults to now)</p></li>
<li><p><strong>valid_window</strong> – extends the validity to this many counter ticks before and after the current one</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if verification succeeded, False otherwise</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-pyotp.hotp">
<dt class="sig sig-object py" id="pyotp.hotp.HOTP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyotp.hotp.</span></span><span class="sig-name descname"><span class="pre">HOTP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyotp/hotp.html#HOTP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.hotp.HOTP" title="Link to this definition">¶</a></dt>
<dd><p>Handler for HMAC-based OTP counters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyotp.hotp.HOTP.at">
<span class="sig-name descname"><span class="pre">at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/hotp.html#HOTP.at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.hotp.HOTP.at" title="Link to this definition">¶</a></dt>
<dd><p>Generates the OTP for the given count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>count</strong> – the OTP HMAC counter</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>OTP</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.hotp.HOTP.provisioning_uri">
<span class="sig-name descname"><span class="pre">provisioning_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/hotp.html#HOTP.provisioning_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.hotp.HOTP.provisioning_uri" title="Link to this definition">¶</a></dt>
<dd><p>Returns the provisioning URI for the OTP.  This can then be
encoded in a QR Code and used to provision an OTP app like
Google Authenticator.</p>
<dl class="simple">
<dt>See also:</dt><dd><p><a class="reference external" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">https://github.com/google/google-authenticator/wiki/Key-Uri-Format</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the user account</p></li>
<li><p><strong>initial_count</strong> – starting HMAC counter value, defaults to 0</p></li>
<li><p><strong>issuer_name</strong> – the name of the OTP issuer; this will be the
organization title of the OTP entry in Authenticator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>provisioning URI</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyotp.hotp.HOTP.verify">
<span class="sig-name descname"><span class="pre">verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">counter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/pyotp/hotp.html#HOTP.verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.hotp.HOTP.verify" title="Link to this definition">¶</a></dt>
<dd><p>Verifies the OTP passed in against the current counter OTP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>otp</strong> – the OTP to check against</p></li>
<li><p><strong>counter</strong> – the OTP HMAC counter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-pyotp.utils">
<dt class="sig sig-object py" id="pyotp.utils.build_uri">
<span class="sig-prename descclassname"><span class="pre">pyotp.utils.</span></span><span class="sig-name descname"><span class="pre">build_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">secret</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/utils.html#build_uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.utils.build_uri" title="Link to this definition">¶</a></dt>
<dd><p>Returns the provisioning URI for the OTP; works for either TOTP or HOTP.</p>
<p>This can then be encoded in a QR Code and used to provision the Google
Authenticator app.</p>
<p>For module-internal use.</p>
<dl class="simple">
<dt>See also:</dt><dd><p><a class="reference external" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">https://github.com/google/google-authenticator/wiki/Key-Uri-Format</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>secret</strong> – the hotp/totp secret used to generate the URI</p></li>
<li><p><strong>name</strong> – name of the account</p></li>
<li><p><strong>initial_count</strong> – starting counter value, defaults to None.
If none, the OTP type will be assumed as TOTP.</p></li>
<li><p><strong>issuer</strong> – the name of the OTP issuer; this will be the
organization title of the OTP entry in Authenticator</p></li>
<li><p><strong>algorithm</strong> – the algorithm used in the OTP generation.</p></li>
<li><p><strong>digits</strong> – the length of the OTP generated code.</p></li>
<li><p><strong>period</strong> – the number of seconds the OTP generator is set to
expire every code.</p></li>
<li><p><strong>kwargs</strong> – other query string parameters to include in the URI</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>provisioning uri</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyotp.utils.strings_equal">
<span class="sig-prename descclassname"><span class="pre">pyotp.utils.</span></span><span class="sig-name descname"><span class="pre">strings_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/pyotp/utils.html#strings_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.utils.strings_equal" title="Link to this definition">¶</a></dt>
<dd><p>Timing-attack resistant string comparison.</p>
<p>Normal comparison using == will short-circuit on the first mismatching
character. This avoids that by scanning the whole string, though we
still reveal to a timing attack whether the strings are the same
length.</p>
</dd></dl>

<dl class="py class" id="module-pyotp.contrib.steam">
<dt class="sig sig-object py" id="pyotp.contrib.steam.Steam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyotp.contrib.steam.</span></span><span class="sig-name descname"><span class="pre">Steam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issuer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyotp/contrib/steam.html#Steam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.contrib.steam.Steam" title="Link to this definition">¶</a></dt>
<dd><p>Steam’s custom TOTP. Subclass of <cite>pyotp.totp.TOTP</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyotp.contrib.steam.Steam.generate_otp">
<span class="sig-name descname"><span class="pre">generate_otp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/pyotp/contrib/steam.html#Steam.generate_otp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyotp.contrib.steam.Steam.generate_otp" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input</strong> – the HMAC counter value to use as the OTP input.
Usually either the counter, or the computed integer based on the Unix timestamp</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id5">
<h1>Change log<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-9-0-2023-07-27">Changes for v2.9.0 (2023-07-27)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-8-0-2022-12-13">Changes for v2.8.0 (2022-12-13)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-7-0-2022-09-11">Changes for v2.7.0 (2022-09-11)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-6-0-2021-02-04">Changes for v2.6.0 (2021-02-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-5-1-2021-01-29">Changes for v2.5.1 (2021-01-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-5-0-2021-01-29">Changes for v2.5.0 (2021-01-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-4-1-2020-10-16">Changes for v2.4.1 (2020-10-16)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-4-0-2020-07-29">Changes for v2.4.0 (2020-07-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-3-0-2019-07-26">Changes for v2.3.0 (2019-07-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-8-2019-07-26">Changes for v2.2.8 (2019-07-26)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-7-2018-11-05">Changes for v2.2.7 (2018-11-05)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-6-2017-06-10">Changes for v2.2.6 (2017-06-10)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-5-2017-06-03">Changes for v2.2.5 (2017-06-03)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-4-2017-01-04">Changes for v2.2.4 (2017-01-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-3-2017-01-04">Changes for v2.2.3 (2017-01-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-2-2017-01-04">Changes for v2.2.2 (2017-01-04)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-1-2016-08-30">Changes for v2.2.1 (2016-08-30)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html#changes-for-v2-2-0-2016-08-30">Changes for v2.2.0 (2016-08-30)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-1-0-2016-05-02">Version 2.1.0 (2016-05-02)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-1-2015-09-28">Version 2.0.1 (2015-09-28)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-2-0-0-2015-08-22">Version 2.0.0 (2015-08-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-4-2-2015-07-21">Version 1.4.2 (2015-07-21)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-1-2012-02-29">Version 1.3.1 (2012-02-29)</a></li>
</ul>
</li>
</ul>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Release Notes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; PyOTP contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">PyOTP - The Python One-Time Password Library</a><ul>
<li><a class="reference internal" href="#quick-overview-of-using-one-time-passwords-on-your-phone">Quick overview of using One Time Passwords on your phone</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#time-based-otps">Time-based OTPs</a></li>
<li><a class="reference internal" href="#counter-based-otps">Counter-based OTPs</a></li>
<li><a class="reference internal" href="#generating-a-secret-key">Generating a Secret Key</a></li>
<li><a class="reference internal" href="#google-authenticator-compatible">Google Authenticator Compatible</a></li>
<li><a class="reference internal" href="#working-example">Working example</a></li>
<li><a class="reference internal" href="#third-party-contributions">Third-party contributions</a></li>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pyotp">API documentation</a><ul>
<li><a class="reference internal" href="#pyotp.parse_uri"><code class="docutils literal notranslate"><span class="pre">parse_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP"><code class="docutils literal notranslate"><span class="pre">TOTP</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.totp.TOTP.at"><code class="docutils literal notranslate"><span class="pre">TOTP.at()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.now"><code class="docutils literal notranslate"><span class="pre">TOTP.now()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.provisioning_uri"><code class="docutils literal notranslate"><span class="pre">TOTP.provisioning_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.timecode"><code class="docutils literal notranslate"><span class="pre">TOTP.timecode()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.totp.TOTP.verify"><code class="docutils literal notranslate"><span class="pre">TOTP.verify()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP"><code class="docutils literal notranslate"><span class="pre">HOTP</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.at"><code class="docutils literal notranslate"><span class="pre">HOTP.at()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.provisioning_uri"><code class="docutils literal notranslate"><span class="pre">HOTP.provisioning_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.hotp.HOTP.verify"><code class="docutils literal notranslate"><span class="pre">HOTP.verify()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyotp.utils.build_uri"><code class="docutils literal notranslate"><span class="pre">build_uri()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.utils.strings_equal"><code class="docutils literal notranslate"><span class="pre">strings_equal()</span></code></a></li>
<li><a class="reference internal" href="#pyotp.contrib.steam.Steam"><code class="docutils literal notranslate"><span class="pre">Steam</span></code></a><ul>
<li><a class="reference internal" href="#pyotp.contrib.steam.Steam.generate_otp"><code class="docutils literal notranslate"><span class="pre">Steam.generate_otp()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id5">Change log</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>